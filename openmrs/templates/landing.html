{% extends "_base.html" %}
{% load url from future %}

{% block content %}
    <div class=container-fluid>
        <div class=row-fluid>
            <div class=span12>
                <div class=hero-unit>
                    <h1 class=heading>Harvest + OpenMRS</h1>
                    <h4>Explore a subset of the OpenMRS demo data with Harvest</h4>
                    <a href="{% url "query" %}" class="btn btn-primary">To The Demo!</a>
                </div>
            </div>
        </div>

        <div id=tutorial class=row-fluid>
            <div class="span12 well">

            <h2>Tutorial</h2>

            <p>Harvest enables and builds upon the <em>iterative</em> nature of data discovery,
            and ultimately, hypothesis-driven research. To get you started, follow this step-by-step
            example or feel free to <a href="{% url "query" %}">dive in</a> and explore
            yourself!</p>

            <div class=row-fluid>
                <div class=span2>
                    <span class=step-number><span>1</span></span>
                </div>

                <div class=span10>
                    <h3>Open the Demo</h3>
                    To get started, click <a target=_blank class="btn btn-primary" href="{% url "query" %}">To the Demo!</a>
                    to open the demo in a new tab/window. There is a "Tutorial" link at the top-left corner of the page that
                    will bring up a dialog for reference if your prefer to not switch back and forth between windows/tabs.
                </div>
            </div>

            <div class=row-fluid>
                <div class=span2>
                    <span class=step-number><span>2</span></span>
                </div>

                <div class=span10>
                    <h3>Tour of the <em>Data Concept</em></h3>

                    <p>A <em>data concept</em> is a conceptual representation (hence the name) of
                    one or more discrete fields. One of the core philosophies of Harvest is to
                    ensure when users look at their data, the <em>context</em> makes sense. Data
                    concepts provide this context for the fields that are contained within it.</p>

                    <p>Let's get started by exploring the interface a bit. On the left side of the page you will
                    see a list of categories. Click on one of the categories to expand it and see the available
                    <em>data concepts</em>, or just <em>concepts</em> for short. Click on any concept that
                    you'd like to view. Upon clicking on the concept, a box will appear in the middle
                    area of the page. This is called the <em>concept view</em>.</p>

                    <p>The concept view itself has a few descriptive areas and buttons to note.</p>

                    <p>
                    <dt>Concept Name</dt>
                    <dd>The name of the concept is displayed at the top left.</dd>
                    <dt>Category</dt>
                    <dd>The name of the category is displayed to the right of the concept name.</dd>
                    <dt>Info</dt>
                    <dd>The <button class="btn btn-small"><i class=icon-info-sign></i> Info</button> button can be clicked to expand and show additional information about the concept.</dd>
                    <dt>Hide</dt>
                    <dd>Concept views remain in the middle of the page unless you click on the <button class="btn btn-mini"><i class=icon-minus></i> Hide</button> button.</dd>
                    </p>

                    <p>Each Data Concept has one or more queryable fields contained within it. These
                    fields are generally always related and this arrangment makes it easier to see all
                    the available queryable fields in one place. Each one of these queryable fields have a form
                    control that is used to enter and add a query condition. Depending on the type
                    of data, the most appropriate form control will be available.</p>
                </div>
            </div>

            <div class=row-fluid>
                <div class=span2>
                    <span class=step-number><span>3</span></span>
                </div>

                <div class=span10>

                    <h3>Form Controls</h3>

                    <p>There are two main <em>types</em> of data, text-based and numerical.
                    To accomondate thinking about and querying these types, different
                    <em>form controls</em> are used for filling out the query conditions.
                    Let's view an example of each.</p>

                    <strong>Text-based Form Control</strong>

                    <p>Click on <code>Encounter</code> &rarr; <code>Diagnosis</code> (on the left).
                    The concept view will appear in the middle area, but now let's focus our attention
                    to <em>input box</em> form control. Something that looks like this..</p>

                    <div class=input-prepend>
                        <span class=add-on><i class=icon-search></i></span><span><input type=text placeholder="e.g. some value..">
                    </div>

                    <p>As you start typing, a list of choices appear that you can choose from.
                    Certain data (like Diagnosis) have quite a few choices to choose from, so it's not practical
                    to wade through all of them manually or feel like you're scrolling an infinite list
                    of choices.</p>

                    <strong>Numerical Form Control</strong>

                    <p>Click on <code>Lab Measurements</code> &rarr; <code>Hemoglobin (HGB)</code> to view
                    an example. You will be presented with a different set of form controls appropriate for
                    querying on numerical data. There is a dropdown list of common operators and an input
                    box to put a numerical value.</p>

                    <p>To help you <em>get a sense</em> of the data, you will notice a few statistics
                    displayed, including <strong>Avg</strong>, <strong>Min</strong> and <strong>Max</strong>.
                    An even more useful visual is the chart which displays the distribution of the data. In
                    this particular example, you will immediately see the outliers on the far right of the
                    chart.</p>

                    <p>The remaining components you will see in the concept view are specific to each
                    field control.</p>

                    <p>
                    <dt>Defintion</dt>
                        <dd>The definition of the field is provided below the form controls.</dd>
                    <dt>Statistics</dt>
                        <dd>Numerical data will display various stats including min, max and average and
                    categorical data will display the distinct count of values for the field.</dd>
                    <dt>Chart</dt>
                        <dd>A real-time look at the dataset to help you get a sense of the data to make educated decisions on the query conditions you want to apply. If there are too many discrete values (as is often the case with numeric values) a clustered histogram will be presented. If this is the case, <span class="label label-info">Clustered</span> will be shown at the top of the chart.</dd>
                    </p>

                    <p>The final elements to notice are the couple of buttons <button class="btn btn-mini btn-warning">Exclude</button> and <button class="btn btn-mini btn-success">Include</button>. These buttons are used to
                    actually <em>add</em> a condition to your query. Clicking on <em>exclude</em>
                    will exclude the data that matches your condition, while clicking on <em>include</em> will
                    only include the data that matches your condition. In the next section, we will make use of these
                    buttons.</p>
                </div>
            </div>

            <div class=row-fluid>
                <div class=span2>
                    <span class=step-number><span>4</span></span>
                </div>

                <div class=span10>

                    <h3>Example Query</h3>

                    <p>Now that you know what you're looking at, let's add a few query conditions!</p>

                    <p>For our example, we're going to look for "female patients who are not classified as having
                    an Asymptomatic HIV infection or as HIV CDC Category A and have a CD4 Count less than 300".
                    Let's begin by selecting the concept <code>Gender</code> under <code>Patient Details</code>.</p>
                    <p>First, let's look at the components for our example:</p>

                    <p>
                    <dt>Concept Name</dt>
                    <dd>Gender</dd>

                    <dt>Category Name</dt>
                    <dd>Patient Details</dd>

                    <dt>Form Controls</dt>
                    <dd>F and M are the only acceptable answer options.  You can view all of the options by selecting the box, or begin typing to see whether any options match your search criteria.  Answers matching your criteria can be selected from the auto-generated list.</dd>

                    <dt>Defintion</dt>
                    <dd>"Self-identified gender where gender is the assemblage of properties that distinguish people on the basis of the societal roles (ORDR;HLF Table 0001 (with additions))"</dd>

                    <dt>Distinct Count</dt>
                    <dd>3 (Unavailable, F, M)</dd>

                    <dt>Chart</dt>
                    <dd>3 bars indicating Unavailable, F, and M are shown along with their frequency of appearance in the dataset.</dd>
                    </p>

                    <p>For our example, we'll type "F" into the search box, then hit return to select the
                    auto-populated option. Next, click on the <button class="btn btn-mini btn-success">Include</button>
                    button. The filter now appears on the right side under <strong>Applied Filters</strong>.
                    This filters the dataset from 5.3K patients to 3.5K patients which is displayed in the upper
                    left corner, below the site name. Note that the <button class="btn btn-mini btn-danger">Remove</button>
                    button has now appeared to the left of the other buttons.</p>

                    <p>For the HIV category classification, we click on the <code>HIV CDC Category</code>
                    under <code>Disease Management</code>. In the search box, start typing "Asymptomatic HIV
                    Infection, CDC Category A", click on the correct choice and click on <button class="btn btn-mini btn-warning">Exclude</button>.
                    The dataset is now reduced to 3.3K patients.</p>

                    <p>Finally, to filter based on CD4 count, we click on the <code>CD4 Count</code> under
                    <code>Lab Measurements</code> (located under the "Other" section).  Select "is less than" in the numerical operator dropdown and type "300"
                    into the text box. Click <button class="btn btn-mini btn-success">Include</button>.
                    The dataset is now reduced to 540 patients.</p>

                    <p>In our Applied Filters panel we now have the following:</p>
                    <ul>
                        <li>Patient Gender includes F</li>
                        <li>HIV CDC Category excludes ASYMPTOMATIC HIV INFECTION and CDC CATEGORY A</li>
                        <li>CD4 Count is less than 300</li>
                    </ul>
                </div>
            </div>

            <div class=row-fluid>
                <div class=span2>
                    <span class=step-number><span>5</span></span>
                </div>

                <div class=span10>
                    <h3>View Your Results</h3>

                    <p>Now that we have filters in place, let's start looking at our data. To begin,
                    click on <button class="btn btn-primary">View Results</button> at the bottom of
                    the list of Applied Filters. Alternatively, you can click the "Review" link at
                    the top of the page.</p>

                    <p>The data will load and a table will be displayed with a few default columns
                    including: MRN, Current Age, Gender, Diagnosis, Medication, and Review of Systems.
                    To see more results of the query, simply continue to scroll down and additional records
                    will be loaded.</p>

                    <p>The next couple sections explain how to order your data and change which columns
                    you are viewing.</p>
                </div>
            </div>

            <div class=row-fluid>
                <div class=span2>
                    <span class=step-number><span>6</span></span>
                </div>

                <div class=span10>
                    <h3>Order the Data</h3>

                    <p>The data can be ordered by simply clicking on any of the column names.
                    Clicking the column once will order the data ascending by that field and clicking
                    the field again will order the data descending by that field. Clicking a third time
                    will remove the ordering for that column.</p>
                </div>
            </div>

            <div class=row-fluid>
                <div class=span2>
                    <span class=step-number><span>7</span></span>
                </div>

                <div class=span10>
                    <h3>Customize Your View</h3>

                    <p>It is possible to customize the view of the data by clicking the
                    <button class="btn"><i class=icon-list></i></button> button at
                    the top right of the page. All available data concepts for display are provided.
                    To add a concept for view, click the <button class="btn btn-success btn-mini">+</button> button on the
                    items on the left. To remove items from view, click the
                    <button class="btn btn-danger btn-mini">-</button> button next to the concept name.
                    You can reorder the list of chosen items by clicking on an item and dragging and dropping
                    it to create the preferred order. Select <button class="btn btn-primary">Save</button>
                    to save the view and return to the data.</p>
                </div>
            </div>

            <div class=row-fluid>
                <div class=span2>
                    <span class=step-number><span>8</span></span>
                </div>

                <div class=span10>
                    <h3>Patient Summary</h3>

                    <p>If you'd like to look at a patient summary, select the MRN of the patient.
                    This view contains the MRN, gender, birthday, and current age of the patient as
                    well as details about each encounter that the patients has had. The most recent
                    encounter appears at the top of the encounter descriptions and is identified by
                    the date and patient age at encounter. The encounter record displays the
                    information available for that encounter.</p>

                    <p>When you're done exploring the data, click the "Discover" link at the top of
                    the page to return to the query interface. Apply some new filters and keep exploring!</p>
                </div>
            </div>

       </div>
    </div>
{% endblock %}
